@tailwind base;
@tailwind components;
@tailwind utilities;

/* Word Document Styling - minimize overrides to preserve original DOCX formatting */
.word-document-preview {
  /* Avoid interfering with DOCX-rendered layout */
  max-width: none;
}

/* Minimal diff highlighting styles - preserve original formatting completely */
.word-document-preview .diff-insert { background-color: #d4edda; color: #155724; text-decoration: none; font-weight: inherit; font-family: inherit; font-size: inherit; line-height: inherit; white-space: pre-wrap; }
.word-document-preview .diff-delete { background-color: #f8d7da; color: #721c24; text-decoration: line-through; font-weight: inherit; font-family: inherit; font-size: inherit; line-height: inherit; white-space: pre-wrap; }

/* Ensure diff highlighting doesn't affect layout */
.word-document-preview .diff-insert,
.word-document-preview .diff-delete { box-sizing: border-box; vertical-align: baseline; white-space: inherit; word-spacing: inherit; letter-spacing: inherit; }

/* Git-like diff highlighting - similar to Git diff output */
.word-document-preview .git-line-added { background-color: #e7f7eb; border-left: 4px solid #28a745; padding: 8px 12px; margin: 4px 0; border-radius: 4px; }
.word-document-preview .git-line-removed { background-color: #fde7ea; border-left: 4px solid #dc3545; padding: 8px 12px; margin: 4px 0; border-radius: 4px; text-decoration: line-through; }
.word-document-preview .git-line-modified { background-color: #fff7e0; border-left: 4px solid #ffc107; padding: 8px 12px; margin: 4px 0; border-radius: 4px; }

/* Inline highlighting for changes within lines */
.word-document-preview .git-inline-added { background-color: #d4edda; color: #155724; padding: 2px 4px; border-radius: 3px; font-weight: 500; white-space: pre-wrap; }
.word-document-preview .git-inline-removed { background-color: #f8d7da; color: #721c24; padding: 2px 4px; border-radius: 3px; text-decoration: line-through; font-weight: 500; white-space: pre-wrap; }

/* Table cell Git-like highlighting */
.word-document-preview .git-cell-added { background-color: #e7f7eb; border: 2px solid #28a745; }
.word-document-preview .git-cell-removed { background-color: #fde7ea; border: 2px solid #dc3545; }
.word-document-preview .git-cell-modified { background-color: #fff7e0; border: 2px solid #ffc107; }

/* Preserve original formatting while highlighting */
.word-document-preview .git-line-added,
.word-document-preview .git-line-removed { font-family: inherit; font-size: inherit; line-height: inherit; white-space: pre-wrap; }

/* Structural highlights (minimal, non-intrusive) */
.word-document-preview img.structural-added,
.word-document-preview table.structural-added {
  outline: 2px solid #28a745;
  outline-offset: 2px;
}

.word-document-preview img.structural-removed,
.word-document-preview table.structural-removed {
  outline: 2px solid #dc3545;
  outline-offset: 2px;
}

.word-document-preview img.structural-modified,
.word-document-preview table.structural-modified {
  outline: 2px solid #ffc107;
  outline-offset: 2px;
}

/* Table cell-level highlights */
.word-document-preview td.cell-added,
.word-document-preview th.cell-added {
  background-color: #e7f7eb;
}

.word-document-preview td.cell-removed,
.word-document-preview th.cell-removed {
  background-color: #fde7ea;
}

.word-document-preview td.cell-modified,
.word-document-preview th.cell-modified {
  background-color: #fff7e0;
}

/* Preserve table formatting in diff mode */
.word-document-preview table.word-table .diff-insert,
.word-document-preview table.word-table .diff-delete {
  display: inline;
  padding: 0;
  margin: 0;
}

/* Preserve list formatting in diff mode */
.word-document-preview li .diff-insert,
.word-document-preview li .diff-delete {
  display: inline;
  padding: 0;
  margin: 0;
}

/* Preserve heading formatting in diff mode */
.word-document-preview h1 .diff-insert,
.word-document-preview h1 .diff-delete,
.word-document-preview h2 .diff-insert,
.word-document-preview h2 .diff-delete,
.word-document-preview h3 .diff-insert,
.word-document-preview h3 .diff-delete,
.word-document-preview h4 .diff-insert,
.word-document-preview h4 .diff-delete,
.word-document-preview h5 .diff-insert,
.word-document-preview h5 .diff-delete,
.word-document-preview h6 .diff-insert,
.word-document-preview h6 .diff-delete {
  display: inline;
  padding: 0;
  margin: 0;
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
}

/* Preserve paragraph formatting in diff mode */
.word-document-preview p .diff-insert,
.word-document-preview p .diff-delete {
  display: inline;
  padding: 0;
  margin: 0;
  line-height: inherit;
  text-indent: inherit;
}

/* Preserve blockquote formatting in diff mode */
.word-document-preview blockquote .diff-insert,
.word-document-preview blockquote .diff-delete {
  display: inline;
  padding: 0;
  margin: 0;
  font-style: inherit;
}

/* Do not alter image sizing or borders; rely on DOCX-rendered styles */

/* Responsive design */
@media (max-width: 768px) {
  .word-document-preview {
    font-size: 14px;
    line-height: 1.5;
  }
  
  .word-document-preview h1 {
    font-size: 1.8em;
  }
  
  .word-document-preview h2 {
    font-size: 1.4em;
  }
  
  .word-document-preview table.word-table {
    font-size: 12px;
  }
  
  .word-document-preview table.word-table th,
  .word-document-preview table.word-table td {
    padding: 6px 8px;
  }
}